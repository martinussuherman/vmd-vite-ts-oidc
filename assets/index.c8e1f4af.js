import{C as d}from"./mergeData.33032ea6.js";import{m as c,T as h}from"./mixins.920312b6.js";import{T as u}from"./index.22df8b11.js";import{V as v,B as y,G as m,k as l,e as f,H as p}from"./main.1db1b49a.js";var g=c(d,h,u).extend({name:"v-overlay",props:{absolute:Boolean,color:{type:String,default:"#212121"},dark:{type:Boolean,default:!0},opacity:{type:[Number,String],default:.46},value:{default:!0},zIndex:{type:[Number,String],default:5}},computed:{__scrim(){const e=this.setBackgroundColor(this.color,{staticClass:"v-overlay__scrim",style:{opacity:this.computedOpacity}});return this.$createElement("div",e)},classes(){return{"v-overlay--absolute":this.absolute,"v-overlay--active":this.isActive,...this.themeClasses}},computedOpacity(){return Number(this.isActive?this.opacity:0)},styles(){return{zIndex:this.zIndex}}},methods:{genContent(){return this.$createElement("div",{staticClass:"v-overlay__content"},this.$slots.default)}},render(e){const t=[this.__scrim];return this.isActive&&t.push(this.genContent()),e("div",{staticClass:"v-overlay",on:this.$listeners,class:this.classes,style:this.styles},t)}}),C=v.extend().extend({name:"overlayable",props:{hideOverlay:Boolean,overlayColor:String,overlayOpacity:[Number,String]},data(){return{animationFrame:0,overlay:null}},watch:{hideOverlay(e){!this.isActive||(e?this.removeOverlay():this.genOverlay())}},beforeDestroy(){this.removeOverlay()},methods:{createOverlay(){const e=new g({propsData:{absolute:this.absolute,value:!1,color:this.overlayColor,opacity:this.overlayOpacity}});e.$mount();const t=this.absolute?this.$el.parentNode:document.querySelector("[data-app]");t&&t.insertBefore(e.$el,t.firstChild),this.overlay=e},genOverlay(){if(this.hideScroll(),!this.hideOverlay)return this.overlay||this.createOverlay(),this.animationFrame=requestAnimationFrame(()=>{!this.overlay||(this.activeZIndex!==void 0?this.overlay.zIndex=String(this.activeZIndex-1):this.$el&&(this.overlay.zIndex=y(this.$el)),this.overlay.value=!0)}),!0},removeOverlay(e=!0){this.overlay&&(m(this.overlay.$el,"transitionend",()=>{!this.overlay||!this.overlay.$el||!this.overlay.$el.parentNode||this.overlay.value||this.isActive||(this.overlay.$el.parentNode.removeChild(this.overlay.$el),this.overlay.$destroy(),this.overlay=null)}),cancelAnimationFrame(this.animationFrame),this.overlay.value=!1),e&&this.showScroll()},scrollListener(e){if("key"in e){if(["INPUT","TEXTAREA","SELECT"].includes(e.target.tagName)||e.target.isContentEditable)return;const t=[l.up,l.pageup],r=[l.down,l.pagedown];if(t.includes(e.keyCode))e.deltaY=-1;else if(r.includes(e.keyCode))e.deltaY=1;else return}(e.target===this.overlay||e.type!=="keydown"&&e.target===document.body||this.checkPath(e))&&e.preventDefault()},hasScrollbar(e){if(!e||e.nodeType!==Node.ELEMENT_NODE)return!1;const t=window.getComputedStyle(e);return(["auto","scroll"].includes(t.overflowY)||e.tagName==="SELECT")&&e.scrollHeight>e.clientHeight||["auto","scroll"].includes(t.overflowX)&&e.scrollWidth>e.clientWidth},shouldScroll(e,t){if(e.hasAttribute("data-app"))return!1;const r=t.shiftKey||t.deltaX?"x":"y",s=r==="y"?t.deltaY:t.deltaX||t.deltaY;let i,o;r==="y"?(i=e.scrollTop===0,o=e.scrollTop+e.clientHeight===e.scrollHeight):(i=e.scrollLeft===0,o=e.scrollLeft+e.clientWidth===e.scrollWidth);const a=s<0,n=s>0;return!i&&a||!o&&n?!0:i||o?this.shouldScroll(e.parentNode,t):!1},isInside(e,t){return e===t?!0:e===null||e===document.body?!1:this.isInside(e.parentNode,t)},checkPath(e){const t=f(e);if(e.type==="keydown"&&t[0]===document.body){const r=this.$refs.dialog,s=window.getSelection().anchorNode;return r&&this.hasScrollbar(r)&&this.isInside(s,r)?!this.shouldScroll(r,e):!0}for(let r=0;r<t.length;r++){const s=t[r];if(s===document||s===document.documentElement||s===this.$refs.content)return!0;if(this.hasScrollbar(s))return!this.shouldScroll(s,e)}return!0},hideScroll(){this.$vuetify.breakpoint.smAndDown?document.documentElement.classList.add("overflow-y-hidden"):(p(window,"wheel",this.scrollListener,{passive:!1}),window.addEventListener("keydown",this.scrollListener))},showScroll(){document.documentElement.classList.remove("overflow-y-hidden"),window.removeEventListener("wheel",this.scrollListener),window.removeEventListener("keydown",this.scrollListener)}}});export{C as O};
